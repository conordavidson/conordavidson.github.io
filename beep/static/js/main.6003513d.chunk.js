(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(19)},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),s=n(10),i=n.n(s),o=n(1),u=n(2),l=n(4),p=n(3),d=n(5),h=Object(r.createContext)({}),y=h.Consumer,f=h.Provider,m=function(e){return function(t){function n(){return Object(o.a)(this,n),Object(l.a)(this,Object(p.a)(n).apply(this,arguments))}return Object(d.a)(n,t),Object(u.a)(n,[{key:"render",value:function(){var t=this;return c.a.createElement(y,null,function(n){return c.a.createElement(e,Object.assign({},t.props,{audioContext:n}))})}}]),n}(r.Component)},b=Object(r.createContext)({}),O=b.Provider,j=b.Consumer,k=function(e){return function(t){function n(){return Object(o.a)(this,n),Object(l.a)(this,Object(p.a)(n).apply(this,arguments))}return Object(d.a)(n,t),Object(u.a)(n,[{key:"render",value:function(){var t=this;return c.a.createElement(j,null,function(n){return c.a.createElement(e,Object.assign({},t.props,{soundBank:n}))})}}]),n}(r.Component)},v=n(7),g=n(6),E=n(11),C=Object(r.createContext)({}),S=C.Provider,w=C.Consumer,N=function(e){return function(t){function n(){return Object(o.a)(this,n),Object(l.a)(this,Object(p.a)(n).apply(this,arguments))}return Object(d.a)(n,t),Object(u.a)(n,[{key:"render",value:function(){var t=this;return c.a.createElement(w,null,function(n){return c.a.createElement(e,Object.assign({},t.props,{drumMachineActions:n}))})}}]),n}(r.Component)},x=Object(r.createContext)({}),K=x.Provider,q=x.Consumer,A=function(e){return function(t){function n(){return Object(o.a)(this,n),Object(l.a)(this,Object(p.a)(n).apply(this,arguments))}return Object(d.a)(n,t),Object(u.a)(n,[{key:"render",value:function(){var t=this;return c.a.createElement(q,null,function(n){return c.a.createElement(e,Object.assign({},t.props,{drumMachineState:n}))})}}]),n}(r.Component)},B=function(e){return Object.keys(e).map(function(t){return e[t]})},M=n(8),P=n.n(M),I=m(k(function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).SEQUENCE_LENGTH=16,n.deriveTracksFromSoundBank=function(){var e=n.props.soundBank;return B(e).reduce(function(e,t){return e[t.id]={soundId:t.id,sequence:new Array(n.SEQUENCE_LENGTH).fill(0)},e},{})},n.state={playing:!1,bpm:120,tracks:n.deriveTracksFromSoundBank(),noteIndex:0},n.setSequenceNote=function(e,t,a){var r=Object(E.a)(n.state.tracks[e].sequence);return r[t]=a,n.setState({tracks:Object(g.a)({},n.state.tracks,Object(v.a)({},e,Object(g.a)({},n.state.tracks[e],{sequence:r})))})},n.play=function(){n.state.playing||n.setState({playing:!0},function(){return n.playNoteAt(0)})},n.stop=function(){n.state.playing&&n.setState({playing:!1})},n.setBpm=function(e){return n.setState({bpm:e})},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"playNoteAt",value:function(e){var t=this;if(this.state.playing)return this.tracksAsArray.forEach(function(n){n.sequence[e]&&t.props.audioContext.playSound(n.soundId)}),this.setState({noteIndex:e}),setTimeout(function(){return e===t.SEQUENCE_LENGTH-1?t.playNoteAt(0):t.playNoteAt(e+1)},this.beatsPerMillisecond)}},{key:"render",value:function(){return c.a.createElement("div",{className:"border-gray p1_5 inline-block"},c.a.createElement(K,{value:{playing:this.state.playing,bpm:this.state.bpm,noteIndex:this.state.noteIndex}},c.a.createElement(S,{value:{setSequenceNote:this.setSequenceNote,play:this.play,stop:this.stop,setBpm:this.setBpm}},c.a.createElement(_,null),c.a.createElement(U,{tracks:this.tracksAsArray}),c.a.createElement(T,null))))}},{key:"tracksAsArray",get:function(){return B(this.state.tracks)}},{key:"beatsPerMillisecond",get:function(){return 6e4/this.state.bpm}}]),t}(r.Component))),_=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"flex justify-between mb2"},c.a.createElement("span",{className:"uppercase"},"Drum Machine"),c.a.createElement(L,null))}}]),t}(r.Component),L=A(function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=P()("StatusIndicator",{"StatusIndicator--active":this.props.drumMachineState.playing});return c.a.createElement("div",{className:"StatusIndicator__Container"},c.a.createElement("div",{className:e}))}}]),t}(r.Component)),T=A(N(function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"renderPlayButton",value:function(){var e=P()("Button h100 mr_5",{"drop-shadow":!this.props.drumMachineState.playing,"inner-shadow":this.props.drumMachineState.playing});return c.a.createElement("button",{className:e,onClick:this.props.drumMachineActions.play},"play")}},{key:"renderStopButton",value:function(){var e=P()("Button h100",{"drop-shadow":this.props.drumMachineState.playing,"inner-shadow":!this.props.drumMachineState.playing});return c.a.createElement("button",{className:e,onClick:this.props.drumMachineActions.stop},"stop")}},{key:"render",value:function(){return c.a.createElement("div",{className:"Controls flex justify-between mt2"},c.a.createElement("div",{className:"mr2"},this.renderPlayButton(),this.renderStopButton()),c.a.createElement("div",null,c.a.createElement(D,{onChange:this.props.drumMachineActions.setBpm,value:this.props.drumMachineState.bpm})))}}]),t}(r.Component))),D=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){return n.props.onChange(e.target.value)},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"h100 relative"},c.a.createElement("input",{className:"Input h100 inner-shadow",onChange:this.onChange,value:this.props.value,type:"number"}),c.a.createElement("span",{className:"detail color-gray overlay events-none flex justify-end items-center pr2"},"BPM"))}}]),t}(r.Component),U=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.tracks.map(function(e){return c.a.createElement(H,{track:e})})}}]),t}(r.Component),H=k(N(function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).onSequenceKeyClick=function(){return function(e,t){return n.props.drumMachineActions.setSequenceNote(n.props.track.soundId,e,t)}},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"mb1_5"},c.a.createElement("div",{className:"mb_5"},this.soundName),c.a.createElement(z,{sequence:this.props.track.sequence,onClickKey:this.onSequenceKeyClick()}))}},{key:"soundName",get:function(){return this.props.soundBank[this.props.track.soundId].name}}]),t}(r.Component))),z=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"flex"},this.props.sequence.map(function(t,n){return c.a.createElement(F,{note:t,index:n,key:n,onClick:e.props.onClickKey})}))}}]),t}(r.Component),F=A(function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){var e=0===n.props.note?1:0;return n.props.onClick(n.props.index,e)},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:this.classes,onClick:this.onClick})}},{key:"on",get:function(){return 1===this.props.note}},{key:"active",get:function(){return!!this.props.drumMachineState.playing&&this.props.drumMachineState.noteIndex===this.props.index}},{key:"classes",get:function(){return P()("SequenceKey mr_5 border-radius",{"drop-shadow":!this.on,"inner-shadow":this.on,"bg-color-white":!this.active,"bg-color-light-gray":this.active})}}]),t}(r.Component)),G=Object(r.createContext)({}),Q=G.Provider,Y=G.Consumer,J=m(function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={waveform:"sine",keys:{}},n.connectOscillator=function(e){n.setState({keys:Object(g.a)({},n.state.keys,Object(v.a)({},e,Object(g.a)({},n.state.keys[e],{isPressed:!0})))},function(){n.state.keys[e].oscillator.connect(n.props.audioContext.context.destination)})},n.disconnectOscillator=function(e){n.setState({keys:Object(g.a)({},n.state.keys,Object(v.a)({},e,Object(g.a)({},n.state.keys[e],{isPressed:!1})))},function(){n.state.keys[e].oscillator.disconnect()})},n.onKeyDown=function(e){if(n.keyMap.includes(e.key))return n.connectOscillator(e.key)},n.onKeyUp=function(e){if(n.keyMap.includes(e.key))return n.disconnectOscillator(e.key)},n.KEYS=[{trigger:"a",frequency:440},{trigger:"s",frequency:466.1638},{trigger:"d",frequency:493.8833},{trigger:"f",frequency:523.2511},{trigger:"g",frequency:554.3653},{trigger:"h",frequency:587.3295},{trigger:"j",frequency:622.254},{trigger:"k",frequency:659.2551},{trigger:"l",frequency:698.4565},{trigger:";",frequency:739.9888},{trigger:"'",frequency:783.9909},{trigger:"]",frequency:830.6094}],n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.createKeyMap(),this.setKeys(),this.bindKeyboardEvents()}},{key:"createKeyMap",value:function(){this.keyMap=this.KEYS.map(function(e){return e.trigger})}},{key:"setKeys",value:function(){var e=this;return this.setState({keys:this.KEYS.reduce(function(t,n){var a=e.props.audioContext.context.createOscillator();return a.type=e.state.waveform,a.frequency.setValueAtTime(n.frequency,e.props.audioContext.context.currentTime),a.start(),t[n.trigger]={oscillator:a,isPressed:!1,trigger:n.trigger},t},{})})}},{key:"bindKeyboardEvents",value:function(e){document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp)}},{key:"render",value:function(){return c.a.createElement(Q,{value:{pressKey:this.connectOscillator,releaseKey:this.disconnectOscillator}},c.a.createElement("div",{className:"border-gray p1_5 inline-block"},c.a.createElement(V,null),c.a.createElement(R,{keys:this.keys})))}},{key:"keys",get:function(){return B(this.state.keys)}}]),t}(r.Component)),V=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"flex justify-between mb2"},c.a.createElement("span",{className:"uppercase"},"Synthesizer"))}}]),t}(r.Component),R=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"flex"},this.props.keys.map(function(t,n){var a=n===e.props.keys.length-1;return c.a.createElement(X,{keyObj:t,isLastKey:a})}))}}]),t}(r.Component),W=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).pressKey=function(){n.props.synthesizerActions.pressKey(n.props.keyObj.trigger)},n.releaseKey=function(){n.props.synthesizerActions.releaseKey(n.props.keyObj.trigger)},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:this.classes,onMouseDown:this.pressKey,onMouseUp:this.releaseKey,onMouseOut:this.releaseKey})}},{key:"classes",get:function(){return P()("SequenceKey bg-color-white border-radius",{mr_5:!this.props.isLastKey,"drop-shadow":!this.props.keyObj.isPressed,"inner-shadow":this.props.keyObj.isPressed})}}]),t}(r.Component),X=(a=W,function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement(Y,null,function(t){return c.a.createElement(a,Object.assign({},e.props,{synthesizerActions:t}))})}}]),t}(r.Component)),Z=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).state={soundsLoaded:!1},n.audioContext=new(AudioContext||window.webkitAudioContext),n.soundFiles=[{id:"hat",name:"Hi\u2014Hat",path:"sounds/hat.wav"},{id:"kick",name:"Kick",path:"sounds/kick.wav"},{id:"snare",name:"Snare",path:"sounds/snare.wav"}],n.soundBank={},n.loadSounds=function(e){return Promise.all(e.map(function(e){return n.loadSound(e)})).then(function(){return n.setState({soundsLoaded:!0})})},n.loadSound=function(e){return fetch(e.path).then(function(e){return e.arrayBuffer()}).then(function(e){return n.audioContext.decodeAudioData(e)}).then(function(t){return n.addSoundToSoundBank({id:e.id,name:e.name,buffer:t})})},n.addSoundToSoundBank=function(e){n.soundBank[e.id]={id:e.id,name:e.name,buffer:e.buffer}},n.playSound=function(e){return n.playBuffer(n.soundBank[e].buffer)},n.playBuffer=function(e){var t=n.audioContext.createBufferSource();t.buffer=e,t.connect(n.audioContext.destination),t.start(0)},n.loadSounds(n.soundFiles),n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.soundsLoaded?c.a.createElement(f,{value:{playSound:this.playSound,context:this.audioContext}},c.a.createElement(O,{value:this.soundBank},c.a.createElement("div",{className:"flex justify-center mt4"},c.a.createElement("div",{className:"mr2"},c.a.createElement(J,null)),c.a.createElement("div",null,c.a.createElement(I,null))))):null}}]),t}(r.Component),$=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("main",null,c.a.createElement(Z,null))}}]),t}(r.Component);n(17);i.a.render(c.a.createElement($,null),document.getElementById("root"))}},[[12,2,1]]]);
//# sourceMappingURL=main.6003513d.chunk.js.map